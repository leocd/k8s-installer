---
- name: 准备provisioner yaml
  template:
    src:  provisioner.yaml.j2
    dest: "{{ global.work_dir }}/provisioner.yaml"

- name: 安装provisioner
  shell: |
    cd {{ global.work_dir }}
    kubectl apply -f provisioner.yaml --kubeconfig=/home/{{ global.user }}//.kube/config

- name: 准备storageclass yaml
  copy:
    src: sc.yaml
    dest: "{{ global.work_dir }}/"

- name: 设置storageclass
  shell: |
    cd {{ global.work_dir }}
    kubectl apply -f sc.yaml --kubeconfig=/home/{{ global.user }}//.kube/configs
